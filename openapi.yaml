openapi: 3.0.3
info:
  title: Travacot Admin API
  version: "1.0.0"
  description: "API for Travacot admin dashboard. Original spec: /mnt/data/initial-api-spec.pdf"
servers:
  - url: http://localhost:8000
paths:
  /api/auth/login:
    post:
      summary: Admin login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email: { type: string }
                password: { type: string }
      responses:
        '200': { description: OK }
  /api/dashboard/kpis:
    get:
      summary: Get KPIs
      parameters:
        - in: query
          name: range
          schema: { type: string, enum: [day, week, month], default: week }
      responses:
        '200':
          description: KPI object
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalBookings: { type: integer }
                  totalRevenue: { type: number }
                  averageBookingValue: { type: number }
  /api/system/health:
    get:
      summary: API & supplier health
      responses:
        '200': { description: OK }
  /api/hotels:
    get:
      summary: List hotels
      parameters:
        - in: query
          name: limit
          schema: { type: integer, default: 20 }
        - in: query
          name: offset
          schema: { type: integer, default: 0 }
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  meta: { type: object }
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Hotel'
    post:
      summary: Create hotel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/HotelCreate'
      responses:
        '200': { description: created }
  /api/hotels/{hotelId}/rooms:
    get:
      summary: Get rooms / availability for a hotel (proxy to supplier if vendor)
      parameters:
        - in: path
          name: hotelId
          required: true
          schema: { type: string }
        - in: query
          name: checkIn
          schema: { type: string, format: date }
        - in: query
          name: checkOut
          schema: { type: string, format: date }
        - in: query
          name: guests
          schema: { type: integer }
      responses:
        '200': { description: OK }
    post:
      summary: Create local room (admin)
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RoomCreate'
  /api/hotels/{hotelId}/rooms/price:
    post:
      summary: Price quote / check rate
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                rateKey: { type: string }
                roomId: { type: integer }
                checkIn: { type: string, format: date }
                checkOut: { type: string, format: date }
                quantity: { type: integer }
      responses:
        '200': { description: OK }
  /api/reservations:
    get:
      summary: List reservations
    post:
      summary: Create booking/reservation
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                hotel_id: { type: integer }
                room_id: { type: integer }
                rateKey: { type: string }
                guest: { type: object }
                billing: { type: object }
      responses:
        '200': { description: OK }
components:
  schemas:
    Hotel:
      type: object
      properties:
        id: { type: integer }
        name: { type: string }
        slug: { type: string }
        country: { type: string }
        city: { type: string }
        vendor: { type: string }
        vendor_id: { type: string }
        lowest_rate: { type: number }
        currency: { type: string }
        status: { type: string }
    HotelCreate:
      type: object
      required: [name]
      properties:
        name: { type: string }
        slug: { type: string }
        country: { type: string }
        city: { type: string }
        vendor: { type: string }
        vendor_id: { type: string }
    RoomCreate:
      type: object
      required: [name]
      properties:
        name: { type: string }
        price_per_night: { type: number }
        refundable: { type: boolean }
        availability: { type: integer }
